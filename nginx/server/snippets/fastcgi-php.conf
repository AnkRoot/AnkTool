# ----------------------------------------------------------------------
# 架构性 PHP-FPM 连接器 V2.1 (Battle-Tested)
# 核心原则:
# 1. 自洽性: 模块包含其运行所需的所有静态真理。
# 2. 健壮性: 建立在官方标准之上，并增加了必要的安全和错误处理。
# ----------------------------------------------------------------------

# 继承 Nginx 官方提供的标准 FastCGI 参数集。
include fastcgi_params;

# --- 增强与优化 ---

# 捕获PHP后端的错误，以便Nginx可以使用 error_page 指令处理它们。
fastcgi_intercept_errors on;

# 将请求分割到 index.php 和路径信息。
fastcgi_split_path_info ^(.+\.php)(/.+)$;

# 当传递的脚本文件不存在时，立即返回404。
try_files $fastcgi_script_name =404;

# [CORRECTED] 直接声明 HTTPS 状态。
# 在我们这个全站强制SSL的架构中，这个值永远是 'on'。
# 直接声明比通过变量传递更清晰、更高效、更不易出错。
fastcgi_param HTTPS 'on';

# [REMOVED] fastcgi_param SCRIPT_FILENAME ...
# 此参数的定义依然是 server 块的责任，这是正确的架构划分。