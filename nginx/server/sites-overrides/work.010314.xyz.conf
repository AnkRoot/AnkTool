# ----------------------------------------------------------------------
# 复合型微服务网关 V2.0 (已继承通用配置)
# 每个 location 只需关注自己的核心职责：代理到哪里。
# ----------------------------------------------------------------------

# --- 规则1: Terminal REST API ---
location /terminal/api {
    if ($work_override_guard = 0) {
        return 444;
    }
    # 只需定义目标。所有必需的头信息都已从 server 块继承。
    proxy_pass http://127.0.0.1:33307/api;
}

location /terminal/ws/ {
    if ($work_override_guard = 0) {
        return 444;
    }
    proxy_pass http://127.0.0.1:33308;
    include snippets/proxy-ws.conf;
}
