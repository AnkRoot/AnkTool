# ----------------------------------------------------
# 通用 Nginx 反向代理增强配置 V2.0
# 此文件应在 server 块中被 include，以便所有 location 继承。
# ----------------------------------------------------

# --- 核心HTTP头转发 ---
# 确保后端服务能获取到真实的客户端信息，而不是Nginx代理的信息。
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;

# --- 代理连接优化 ---
# 启用HTTP/1.1并支持长连接，对现代后端服务至关重要。
proxy_http_version 1.1;